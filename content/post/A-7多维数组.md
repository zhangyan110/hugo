---
author: "张大仙儿"
date: 2019-08-10
title: "数组的索引和切片"
tags: ["Numpy"]
categories: ["Python数据分析之Numpy"]
---

# 多维数组及其属性

## array可以直接生成多维数组（矩阵）：

- 当向np.array() 的括号中传入单个列表时生成一维矩阵，传入一个以列表为元素的列表（**嵌套列表**）时就生成二维的矩阵，以此类推，可生成三维矩阵。

```python
In [1]:a = np.array([[1,2,3,4],
                     [5,6,7,8],
                     [9,10,11,12]])
In [2]:a
Out[2]:array([[ 1,  2,  3,  4],      
              [ 5,  6,  7,  8],
              [ 9, 10, 11, 12]])
In [3]:type(a)
Out[3]:numpy.ndarray
In [4]:a.shape
Out[4]:(3, 4)      #一个三行四列的二维数组
In [5]:a.ndim
Out[5]:2        #2维的
```

- 和一维数组类似，可以生成二维的**全0或全1** 的数组：

```python
In [6]:np.zeros((3,2))
Out[6]:array([[0., 0.],
              [0., 0.],
              [0., 0.]])
In [7]:np.ones((3,3))
Out[7]:array([[1., 1., 1.],
              [1., 1., 1.],
              [1., 1., 1.]])
```

- 也可以生成二维**随机数组**：

```python
In [8]:np.random.random((3,2))
Out[8]:array([[0.57183732, 0.62938469],
              [0.54804516, 0.20184659],
              [0.25673519, 0.12592501]])
```

## 索引和切片

### 1、索引

#### 对于二维数组，索引时可传入两个参数，分别对应两个维度（行、列）：

```python
In [9]:a = np.arange(3*3).reshape((3,3))
In [10]:a
Out[10]:array([[0, 1, 2],
               [3, 4, 5],
               [6, 7, 8]])
In [11]:a[1,1]    #取第二行第二列的值
Out[11]:4
In [12]:a[1,1] = 9    #用来赋值
In [13]:a
Out[13]:array([[0, 1, 2],
               [3, 9, 5],
               [6, 7, 8]])
```

#### 可以用单个参数索引一整行：

```python
In [14]:a[1]
Out[14]:array([3, 9, 5])   #一维的
In [15]:a[:,1]            #所有行的第二列，即整个第二列
Out[15]:array([1, 9, 7])
In [16]:
```

### 2、切片

- 通用的规则：多维数组的任何一维都支持切片的规则，包括索引和省略：

  [lower：upper：step]      

  一般左闭右开，有：的话就包含‘右边’在内

```python
In [17]:a = np.arange(6*6).reshape((6,6))
In [18]:a
Out[18]:
array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20, 21, 22, 23],
       [24, 25, 26, 27, 28, 29],
       [30, 31, 32, 33, 34, 35]])
In [19]:a[0,3:5]     #取第一行的，第4到5的元素
Out[19]:array([3, 4])
In [20]:a[4:,4:]    #取5、6行的5、6 列
In [21]:a[2::2,::2]   #取出第3、5行的奇数列
Out[21]:array([[12, 14, 16],
               [24, 26, 28]])
```

-  需要注意：数组切片使用的是*引用机制*，这意味着改变切片取出的数组中的值，就会改变原数组的值，这一点不同于列表的切片。

​       优点在于：对很大的矩阵，不用复制大量的值，节省空间

​       缺点在于：可能出现改变一个值，也同时改变另一个的情况

​       解决方法：使用copy()就可以直接复制一个，这个复制会申请新的内存

### 3、花式索引

- 切片只能支持连续或者等间隔的切片操作，要实现任意位置的操作，就需要花式索引帮忙啦

#### 一维花式索引：

- 需要给定特定位置上的值

```python
In [22]:a = np.arange(0,100,10)
In [23]:a
Out[23]:array([ 0, 10, 20, 30, 40, 50, 60, 70, 80, 90])
In [24]:index = [1,2,-3]
In [25]:b = a[index]
In [26]:b
Out[26]:array([10, 20, 70])    #就取出了a中第2、3和倒数第3位的元素

```

- 用布尔值数组进行花式索引

```python
In [27]:mask = np.array([0,3,1,0,0,1,0,0,4,0],dtype = 'bool')   
    #其中0是False,非0的都是True;且mask必须是长度和原数组相同
In [28]:a[mask]
Out[28]:array([10, 20, 50, 80])     #取出了所有mask中为True的a中对应的值
```

#### 二维花式索引

- 需给定行和列的值

```python
In [29]:a = np.arange(5*5).reshape((5,5))
In [30]:a
Out[30]:
array([[ 0,  1,  2,  3,  4],
       [ 5,  6,  7,  8,  9],
       [10, 11, 12, 13, 14],
       [15, 16, 17, 18, 19],
       [20, 21, 22, 23, 24]])
In [31]:a[(0,1,2,3,4),(0,1,2,3,4)]    #一一对应的形成一个个坐标对
Out[31]:array([ 0,  6, 12, 18, 24])  #就取出了对角线上的五个元素
```

- 但也有些要注意，区分下面两个例子：

```python
In [32]:a[(2,3,4),(0,2,4)]   #取出最后3行，每行对应第1、3、5列上的元素
Out[32]:array([10, 17, 24])
In [33]:a[2:,(0,2,4)]        #这个是取出最后3行，整个第1、3、5列
Out[33]:
array([[10, 12, 14],
       [15, 17, 19],
       [20, 22, 24]])
```

- 用布尔值索引也是可以的：

```python
In [34]:mask = np.array([1,0,1,0,1],dtype = 'bool')
In [35]:a[mask,2]
Out[35]:array([ 2, 12, 22])
```

注意：与切片不同，花式索引返回的是原对象的一个复制，而非引用

- 当我们用where函数，就可以做到，比如返回所有非0元素的索引：

```python
In [36]:a = np.array([3,5,-6,-3,5,-1,6])
In [37]:np.where(a > 0)
Out[37]:(array([0, 1, 4, 6], dtype=int64),)    #返回的是大于0的元素的索引位置
In [38]:a[a > 0]
Out[38]:array([3, 5, 5, 6])          #返回的是具体的大于0的元素
In [39]:a[np.where(a > 0)]
Out[39]:array([3, 5, 5, 6])
```

